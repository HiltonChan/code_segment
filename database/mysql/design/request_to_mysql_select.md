## MySQL主从架构中从库的选择 ##
### 场景 ###
当一个request请求过来的时候，要求访问MySQL数据库，我们MySQL数据库是主从架构，在多个MySQL服务器中我们应该改如何选择一个MySQL来执行SQL，达到速度最快、延迟最小？

### 曾将的解决方案 ###
##### rand随机筛选 #####
简介：通过随机数产生一个索引，通过索引下标找到对应的数据库连接，执行SQL。<br>
缺点：随机性大，无法判断每个MySQL数据库的状态，容易导致请求集中于几台MySQL上。
##### 一致性哈希 #####
简介：通过虚拟节点的引入，充分将请求均衡分配到各个MySQL节点上，达到负载均衡的效果<br>
缺点：一致性哈希很好解决了因随机性而产生SQL请求分配不均的问题，但是一致性哈希还是不能解决如何使SQL执行延迟小、速度快的问题。

### 问题所在 ###
- 如果选择的MySQL正在进行写操作，一个读请求过来，会因为锁表而产生延迟
- 不同的MySQL因为所部署的环境的原因，在网络中传输会有时延问题

### 我的解决方案 ###
##### 记录SQL执行时间 #####
对每个MySQL数据库都记录SQL的执行时间，用一个array存储MySQL数据库和对应的执行时间，每次对应的MySQL执行一次请求，记录时间并统计成平均值。
##### 处理数记录 #####
记录每个数据库当前未完成的请求数
##### 最优选择 #####
按照公式select = 1/(time*number)计算出对应MySQL库的select值，time是SQL平局执行时间，时间越小，select越大，number是处理数，number越大,select越小，所有time越小，number越小，会产生一个最大的select值，这个select值对应的MySQL库就是我们的最佳选择。

